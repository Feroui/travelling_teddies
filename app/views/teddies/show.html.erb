<div class="container text-center">
  <div class="row">
    <div class="col-xs-12 col-sm-10 col-sm-offset-1">
      <div class="show-teddies-row-top center-items">
        <div class="show-teddies-row-top-id">
          <ul class="list-inline">
            <li> <img src="http://lorempixel.com/80/80/cats/1"/></li>
            <li><h1><%= @teddy.name %></h1></li>
          </ul>
        </div>
        <p> <strong><%= @teddy.name%></strong> was sent by <strong><%= @teddy.stages.first.backpacker_name %></strong>. He started at <strong><%= @teddy.stages.first.adress %></strong> and now he's in <strong><%= @teddy.stages.last.adress %></strong> ! Check out how he arrived here ! </p>
        <div class="show-teddies-follow-button">
          <%= link_to root_path do %>
            Follow <%= @teddy.name %> !
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-sm-10 col-sm-offset-1">
      <div id="map" style="width: 100%; height: 400px;"></div>
    </div>
  </div>
  <div class="row">
    <div class="empty-stage-menu"></div>
    <div class="col-xs-12 col-sm-10 col-sm-offset-1">
      <div class="stage-menu">

          <div class="stage-menu-left">
              <% @stages.reverse.each do |stage| %>
              <% if stage.id.even?  %>
                <div class="card-teddies-show">
                  <div class="car-teddies-title">
                    <div class="teddies-stages-title-menu"><img src="http://lorempixel.com/300/150/nature" /></div>
                    <div class="barre-horrizontale"></div>
                    <div class="black-spot"></div>
                  </div>
                  <div class="card-teddies-stage-description-photo">
                    <div class="card-teddies-stage-description-photo-details">
                      <p><strong> <%= stage.adress %> </strong></p>
                      <p><strong> <%= stage.created_at %></strong>: <%= @teddy.name %> was in <%= stage.adress %></p><%= link_to "see more", teddy_stage_path(@teddy, stage) %>
                    </div>
                    <div class="card-teddies-stage-description-photo-empty"></div>
                  </div>

                </div>
                <% end %>
              <% end %>

          </div>

        <div class="stage-menu-center"></div>

          <div class="stage-menu-right">
              <div class="empty-div-meny"></div>
              <% @stages.reverse.each do |stage| %>
              <% unless stage.id.even? %>
                <div class="card-teddies-show">
                  <div class="car-teddies-title">
                    <div class="black-spot"></div>
                    <div class="barre-horrizontale"></div>
                    <div class="teddies-stages-title-menu"><img src="http://lorempixel.com/300/150/nature" />
                  </div>
                  </div>
                  <div class="card-teddies-stage-description-photo">
                    <div class="card-teddies-stage-description-photo-empty"></div>
                    <div class="card-teddies-stage-description-photo-details">
                      <p><strong> <%= stage.adress %> </strong></p>
                      <p><strong> <%= stage.created_at %></strong>: <%= @teddy.name %> was in <%= stage.adress %></p> <%= link_to "see more", teddy_stage_path(@teddy, stage) %>
                    </div>
                  </div>
                </div>
                <% end %>
              <% end %>
          </div>

      </div>
    </div>
    <div class="empty-stage-menu"></div>
  </div>
</div>

<% content_for(:after_js) do %>
  <%= javascript_tag do %>

    function initMap() {
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 3,
        center: {lat: <%= @last_stage.latitude %>, lng: <%= @last_stage.longitude %>},
        mapTypeId: google.maps.MapTypeId.TERRAIN
      });


      <% @stages.each do |stage| %>
        var marker = new google.maps.Marker({
        position: <%= raw( { lat: stage.latitude, lng: stage.longitude }.to_json) %>,
        map: map,
        title: 'Hello World!'

        });
      <% end %>

      var flightPlanCoordinates = <%= raw(@stages.map { |stage| { lat: stage.latitude, lng: stage.longitude }}.to_json) %>;

      var flightPath = new google.maps.Polyline({
        path: flightPlanCoordinates,
        geodesic: true,
        strokeColor: '#FF0000',
        strokeOpacity: 1.0,
        strokeWeight: 2
      });

      flightPath.setMap(map);
    }

    $(document).ready(function() {
      initMap()
    });

  <% end %>
<% end %>
